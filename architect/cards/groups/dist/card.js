!function(t){var e={};function s(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/",s(s.s=0)}([function(t,e,s){s(1),t.exports=s(2)},function(t,e,s){"use strict";s.r(e);function n(t,e,s,n,o,i,r,a){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=s,c._compiled=!0),n&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),r?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=l):o&&(l=a?function(){o.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(t,e){return l.call(e),d(t,e)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:t,options:c}}var o=n({props:{groupName:{type:String,required:!0},sessionId:{type:Number,required:!0}},data:function(){return{loaded:!1,session:{},showBookings:!1,groupSessionId:0}},mounted:function(){var t=this;Architect.$on("modal-close",(function(e){"inner-member-list"===e.id&&(t.showBookings=!1)})),Architect.request().get("/external/groups/session/".concat(this.sessionId)).then((function(e){t.session=e.data,t.loaded=!0}))},methods:{formatDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Do MMMM YYYY";return moment(t).format(e)},viewMemberList:function(t,e){0!==e&&(this.groupSessionId=t,this.showBookings=!0)}}},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.loaded?s("div",[s("div",[s("h2",{staticClass:"text-xl font-semibold text-center mb-2"},[t._v("\n            "+t._s(t.groupName)+", "+t._s(t.session.day.day)+", "+t._s(t.session.human_start_time)+" - "+t._s(t.session.human_end_time)+"\n        ")]),t._v(" "),s("table",{staticClass:"w-full"},[t._m(0),t._v(" "),s("tbody",t._l(t.session.group_sessions,(function(e){return s("tr",{staticClass:"border-b-2 border-blue-500",class:"past"===e.type?"bg-red-500":"future"===e.type?"bg-green-500":""},[s("td",{staticClass:"p-2 border-r border-blue-500"},[t._v(t._s(t.formatDate(e.date)))]),t._v(" "),s("td",{staticClass:"p-2 text-right",on:{click:function(s){return t.viewMemberList(e.id,e.bookings_count)}}},[t._v("\n                    "+t._s(e.bookings_count)+"/"+t._s(t.session.capacity)+"\n                ")])])})),0)])]),t._v(" "),t.showBookings?s("portal",{attrs:{to:"secondary-modal"}},[s("modal",{attrs:{title:"Member List",id:"inner-member-list"}},[s("div",{staticClass:"w-full bg-gray-100 p-2"},[s("p",[s("a",{attrs:{href:"/admin/api/external/groups/printBookings/"+t.groupSessionId,target:"_blank"}},[t._v("\n                        Printer Friendly List\n                    ")])]),t._v(" "),s("groups-member-list",{attrs:{"group-session-id":t.groupSessionId}})],1)])],1):t._e()],1):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",{staticClass:"bg-blue-500 text-white font-semibold border-b-2 border-white"},[e("th",{staticClass:"text-left w-10/12 p-2 border-r border-white"},[this._v("Date")]),this._v(" "),e("th",{staticClass:"text-left p-2"},[this._v("Members")])])])}],!1,null,null,null).exports,i=n({components:{SessionHistory:o},props:{data:Object|Array,labels:Object|Array},data:function(){return{groups:[],viewedSession:null,viewedName:null,showMemberModal:!1,showSessionDetail:!1,sessionId:null}},mounted:function(){var t=this;Architect.$on("modal-close",(function(e){"member-list"===e.id&&(t.showMemberModal=!1),"session-history"===e.id&&(t.showSessionDetail=!1)})),Architect.request().get("/external/groups/list").then((function(e){t.groups=e.data,t.groups.map((function(e){var s={};e.group_sessions.forEach((function(e){Object.keys(s).includes(e.date)||t.$set(s,e.date,[]),s[e.date].push(e)})),Object.keys(s).forEach((function(t){s[t]=s[t].sort((function(t,e){return parseInt(t.session.start_at.split(":")[0])-parseInt(e.session.start_at.split(":")[0])}))})),e.processedGroups=s}))}))},methods:{formatDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Do MMMM YYYY";return moment(t).format(e)},viewBookings:function(t,e){0!==t.members_count&&(this.viewedName=e,this.viewedSession=t,this.showMemberModal=!0)},viewSessionHistory:function(t,e){this.viewedName=e,this.sessionId=t,this.showSessionDetail=!0}}},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",[s("div",{staticClass:"flex flex-col"},t._l(t.groups,(function(e){return s("div",{staticClass:"bg-blue-100 p-2 rounded my-2"},[s("h3",{staticClass:"text-xl text-gray-900 mb-2 font-semibold"},[t._v(t._s(e.name))]),t._v(" "),t._l(e.processedGroups,(function(n,o){return s("div",[s("h4",{staticClass:"text-gray-700 font-semibold text-lg"},[t._v("\n                        "+t._s(t.formatDate(o))+"\n                    ")]),t._v(" "),s("div",{staticClass:"flex flex-col lg:flex-row lg:justify-between lg:-mx-2 lg:flex-wrap"},t._l(n,(function(n){return n.session.live||n.bookings_count>0?s("div",{staticClass:"p-2 lg:w-1/2"},[s("div",{staticClass:"rounded p-2 flex flex-col",class:n.session.live?"bg-gray-100":"bg-red-500"},[s("div",{staticClass:"flex justify-between"},[s("div",{staticClass:"flex flex-col mb-2"},[s("strong",{staticClass:"font-semibold"},[t._v("Time")]),t._v("\n                                        "+t._s(n.session.human_start_time)+" - "+t._s(n.session.human_end_time)+"\n                                    ")]),t._v(" "),s("div",{staticClass:"flex flex-col mb-2 text-right"},[s("strong",{staticClass:"font-semibold"},[t._v("Bookings")]),t._v(" "),s("a",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"View List",expression:"'View List'"}],staticClass:"font-semibold text-blue-500 hover:underline cursor-pointer",on:{click:function(s){return t.viewBookings(n,e.name)}}},[t._v("\n                                            "+t._s(n.bookings_count)+"/"+t._s(n.session.capacity)+"\n                                        ")])])]),t._v(" "),n.session.weigh_only?s("strong",[t._v("(Weigh Only)"),s("br")]):t._e()])]):t._e()})),0)])})),t._v(" "),s("h4",{staticClass:"text-gray-700 font-semibold text-lg mt-4"},[t._v("View Session History")]),t._v(" "),s("ul",{staticClass:"my-2"},t._l(e.sessions,(function(n){return s("li",{staticClass:"cursor-pointer hover:underline font-semibold",on:{click:function(s){return t.viewSessionHistory(n.id,e.name)}}},[t._v("\n                        "+t._s(n.day.day)+"'s, "+t._s(n.human_start_time)+"\n                    ")])})),0)],2)})),0)]),t._v(" "),t.showMemberModal?s("portal",{attrs:{to:"modal"}},[s("modal",{attrs:{title:"Member List",id:"member-list"}},[s("div",{staticClass:"w-full bg-gray-100 p-2"},[s("p",{staticClass:"font-semibold text-lg"},[t._v("\n                    Member List for "+t._s(t.viewedName)+", "+t._s(t.formatDate(t.viewedSession.date))+" - "+t._s(t.viewedSession.session.human_start_time)+"\n                ")]),t._v(" "),s("p",[s("a",{attrs:{href:"/admin/api/external/groups/printBookings/"+t.viewedSession.id,target:"_blank"}},[t._v("Printer\n                        Friendly List")])]),t._v(" "),s("groups-member-list",{attrs:{"group-session-id":t.viewedSession.id}})],1)])],1):t._e(),t._v(" "),t.showSessionDetail?s("portal",{attrs:{to:"modal"}},[s("modal",{attrs:{title:"Session History",id:"session-history"}},[s("div",{staticClass:"w-full bg-gray-100 p-2"},[s("session-history",{attrs:{"group-name":t.viewedName,"session-id":t.sessionId}})],1)])],1):t._e()],1)}),[],!1,null,null,null).exports,r=n({props:{groupSessionId:{type:Number,required:!0}},data:function(){return{bookings:[],showDetail:null,cancel:{show:!1,booking:null,notify:!0}}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;Architect.request().get("/external/groups/bookings/".concat(this.groupSessionId)).then((function(e){t.bookings=e.data}))},toggleDetails:function(t){this.showDetail!==t?this.showDetail=t:this.showDetail=null},formatDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DD/MM/YY HH:mm";return moment(t).format(e)},cancelBooking:function(t){this.cancel.booking=t,this.cancel.show=!0},confirmCancel:function(){var t=this;Architect.request().post("/external/groups/deleteBooking/".concat(this.cancel.booking.id),{notifyMember:this.cancel.notify}).then((function(){t.dontCancel(),Architect.success("Booking Cancelled"),t.getData()}))},dontCancel:function(){this.cancel.show=!1,this.cancel.notify=!0,this.cancel.booking=null}}},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"flex flex-col"},t._l(t.bookings,(function(e){return s("div",{key:e.id,staticClass:"bg-white rounded p-2 flex flex-col mt-2",on:{click:function(s){return s.ctrlKey||s.shiftKey||s.altKey||s.metaKey?null:t.toggleDetails(e.id)}}},[s("div",{staticClass:"flex"},[s("div",{staticClass:"flex flex-col flex-1"},[s("strong",[t._v(t._s(e.member.name))]),t._v(" "),s("span",[t._v(t._s(e.member.email))])]),t._v(" "),s("div",{staticClass:"flex pr-2 justify-center items-start text-2xl font-thin text-gray-200 hover:text-gray-500 transition-colour"},[s("font-awesome-icon",{attrs:{icon:t.showDetail===e.id?["fas","caret-up"]:["fas","caret-down"]}})],1)]),t._v(" "),s("div",{staticClass:"mt-2"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showDetail===e.id,expression:"showDetail === booking.id"}],staticClass:"flex flex-col border-t border-gray-200 pt-2 text-xs"},[s("div",[s("strong",[t._v("Phone:")]),t._v(" "+t._s(e.member.phone)+"\n                    ")]),t._v(" "),s("div",[s("strong",[t._v("Session ID:")]),t._v(" "+t._s(e.group_session_id)+"\n                    ")]),t._v(" "),s("div",[s("strong",[t._v("Booking Date:")]),t._v(" "+t._s(t.formatDate(e.created_at))+"\n                    ")]),t._v(" "),e.cancelable?s("div",[s("div",{staticClass:"flex-1 py-1 bg-red-500 text-white text-base text-center rounded-lg font-semibold mt-2 slider-bg max-w-98",on:{click:function(s){return t.cancelBooking(e)}}},[t._v("\n                            Cancel Booking\n                        ")])]):t._e()])])])})),0),t._v(" "),t.cancel.show?s("portal",{attrs:{to:"secondary-modal"}},[s("modal",{attrs:{title:"Cancel Booking",id:"cancel-booking",closable:!1}},[s("div",{staticClass:"w-full bg-gray-100 p-2 flex flex-col"},[s("p",[t._v("Are you sure you want to cancel this booking for "+t._s(t.cancel.booking.member.name)+"?")]),t._v(" "),s("div",{staticClass:"flex items-center mt-2"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.cancel.notify,expression:"cancel.notify"}],staticClass:"mr-1",attrs:{type:"checkbox",id:"notify"},domProps:{checked:Array.isArray(t.cancel.notify)?t._i(t.cancel.notify,null)>-1:t.cancel.notify},on:{change:function(e){var s=t.cancel.notify,n=e.target,o=!!n.checked;if(Array.isArray(s)){var i=t._i(s,null);n.checked?i<0&&t.$set(t.cancel,"notify",s.concat([null])):i>-1&&t.$set(t.cancel,"notify",s.slice(0,i).concat(s.slice(i+1)))}else t.$set(t.cancel,"notify",o)}}}),t._v(" "),s("label",{attrs:{for:"notify"}},[t._v("Notify Member")])]),t._v(" "),s("div",{staticClass:"flex flex-col"},[s("div",{staticClass:"flex-1 py-1 bg-red-500 text-white text-base text-center rounded-lg font-semibold mt-2 slider-bg",on:{click:function(e){return t.confirmCancel()}}},[t._v("\n                        Cancel Booking\n                    ")]),t._v(" "),s("div",{staticClass:"flex-1 py-1 bg-green-500 text-white text-base text-center rounded-lg font-semibold mt-2 slider-bg",on:{click:function(e){return t.dontCancel()}}},[t._v("\n                        No, don't cancel\n                    ")])])])])],1):t._e()],1)}),[],!1,null,null,null).exports;Architect.onBoot((function(t){t.component("groups-card",i),t.component("groups-member-list",r),t.component("group-session-history",o)}))},function(t,e){}]);